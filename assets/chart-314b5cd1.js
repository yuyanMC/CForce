var x=Object.defineProperty;var d=(o,i,t)=>i in o?x(o,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[i]=t;var h=(o,i,t)=>(d(o,typeof i!="symbol"?i+"":i,t),t);import{c as l}from"./util-720ff2c1.js";class n{constructor(i){h(this,"notes");h(this,"animationNotes");h(this,"notesTotal");h(this,"length");this.notes=[],this.animationNotes=[],i.notes.forEach(t=>{let s=[];t.paths.forEach(a=>{s.push(n.parsePath(a))});let r=new y(s);t.type!=="I"?this.notes.push(new e(r,t.h,t.track,t.type,t.al,t.track=="A"?[0,220,240]:[220,70,20])):this.notes.push(new e(r,t.h,t.track,t.type,0,t.track=="A"?[0,220,240]:[220,70,20]))}),i.animationNotes.forEach(t=>{let s=[];t.paths.forEach(c=>{s.push(n.parsePath(c))});let r=new y(s),a;t.type!=="I"?a=new e(r,t.h,"M",t.type,t.al,t.fill):a=new e(r,t.h,"M",t.type,void 0,t.fill),a.ho=t.ho,a.hi=t.hi,this.animationNotes.push(a)}),this.notesTotal=i.notes.length,this.length=i.length}static parsePath(i){let t=i,s=new p(0);switch(t.type){case"arc":s=new g(t.spd,t.c[0],t.c[1],t.f[0],t.f[1],t.t[0],t.t[1]);break;case"line":s=new P(t.spd,t.f[0],t.f[1],t.t[0],t.t[1]);break;case"static":s=new w(t.spd,t.pos[0],t.pos[1]);break;case"pow2":s=new E(n.parsePath(t.p),t.f,t.t);break;default:throw Error("Invalid path type")}return s}}class p{constructor(i){h(this,"spd");this.spd=i}cal(i){return[0,0]}}class w extends p{constructor(t,s,r){super(t);h(this,"x");h(this,"y");this.x=s,this.y=r}cal(t){return[this.x,this.y]}}class P extends p{constructor(t,s,r,a,c){super(t);h(this,"fx");h(this,"fy");h(this,"tx");h(this,"ty");this.fx=s,this.fy=r,this.tx=a,this.ty=c}cal(t){return[this.fx+(this.tx-this.fx)*t,this.fy+(this.ty-this.fy)*t]}}class g extends p{constructor(t,s,r,a,c,f=1600,u=900){super(t);h(this,"cx");h(this,"cy");h(this,"fromx");h(this,"fromy");h(this,"tox");h(this,"toy");if((a-s)**2+(c-r)**2-(f-s)**2-(u-r)**2>=.01)throw Error(`Invalid ArcPath for(${s} ${r} ${a} ${c} ${f} ${u})`);this.cx=s,this.cy=r,this.fromx=a,this.fromy=c,this.tox=f,this.toy=u}cal(t){if(t<0)return[this.fromx,this.fromy];if(t>1)return[this.tox,this.toy];let s=l(this.cx,this.cy,this.fromx,this.fromy),r=l(this.cx,this.cy,this.tox,this.toy),a=s+(r-s)*t,c=Math.sqrt((this.tox-this.cx)**2+(this.toy-this.cy)**2);return[Math.cos(a)*c+this.cx,Math.sin(a)*c+this.cy]}}class k extends p{constructor(t){super(t.spd);h(this,"p");this.p=t}}class E extends k{constructor(t,s=0,r=1){super(t);h(this,"f");h(this,"t");this.f=s,this.t=r}cal(t){return this.p.cal((this.f+(this.t-this.f)*t)**2)}}class y extends p{constructor(t){let s=0;t.forEach(a=>{s+=a.spd});super(s);h(this,"ps");h(this,"ssp");this.ps=t,this.ssp=[];let r=0;this.ssp.push(0),t.forEach(a=>{r+=a.spd,this.ssp.push(r/s)})}cal(t){for(let s=1;s<this.ssp.length;s++)if(t<this.ssp[s]){let r=(t-this.ssp[s-1])/(this.ssp[s]-this.ssp[s-1]);return this.ps[s-1].cal(r)}return this.ps[this.ps.length-1].cal(1)}}class e{constructor(i,t,s,r,a,c){h(this,"p");h(this,"h");h(this,"a");h(this,"aa");h(this,"ho");h(this,"hi");h(this,"t");h(this,"y");h(this,"al");h(this,"_f");this.p=i,this.h=t,this.t=s,this.y=r,this.a=0,this.aa=0,this.y=="A"&&a==null&&(a=0),this.al=a,this._f=c||[64,64,64]}get f(){return this.t=="A"?[0,220,240]:this.t=="B"?[220,70,20]:this._f}set f(i){this._f=i}}export{n as Chart,e as Note,p as Path};
